(()=>{"use strict";var t=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function r(){var t=new i(3);return i!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function e(t){var i=t[0],r=t[1],e=t[2];return Math.hypot(i,r,e)}function o(t,r,e){var o=new i(3);return o[0]=t,o[1]=r,o[2]=e,o}function n(t,i,r){return t[0]=i[0]-r[0],t[1]=i[1]-r[1],t[2]=i[2]-r[2],t}Math.hypot||(Math.hypot=function(){for(var t=0,i=arguments.length;i--;)t+=arguments[i]*arguments[i];return Math.sqrt(t)});!function(){var t=r()}();function a(){var t=new i(16);return i!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function s(t,i,r){var e,o,n,a,s,h,u,f,l,c,m,d,A=r[0],g=r[1],v=r[2];return i===t?(t[12]=i[0]*A+i[4]*g+i[8]*v+i[12],t[13]=i[1]*A+i[5]*g+i[9]*v+i[13],t[14]=i[2]*A+i[6]*g+i[10]*v+i[14],t[15]=i[3]*A+i[7]*g+i[11]*v+i[15]):(e=i[0],o=i[1],n=i[2],a=i[3],s=i[4],h=i[5],u=i[6],f=i[7],l=i[8],c=i[9],m=i[10],d=i[11],t[0]=e,t[1]=o,t[2]=n,t[3]=a,t[4]=s,t[5]=h,t[6]=u,t[7]=f,t[8]=l,t[9]=c,t[10]=m,t[11]=d,t[12]=e*A+s*g+l*v+i[12],t[13]=o*A+h*g+c*v+i[13],t[14]=n*A+u*g+m*v+i[14],t[15]=a*A+f*g+d*v+i[15]),t}function h(t,i,r){var e=r[0],o=r[1],n=r[2];return t[0]=i[0]*e,t[1]=i[1]*e,t[2]=i[2]*e,t[3]=i[3]*e,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=i[7]*o,t[8]=i[8]*n,t[9]=i[9]*n,t[10]=i[10]*n,t[11]=i[11]*n,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t}function u(i,r,e,o){var n,a,s,h,u,f,l,c,m,d,A,g,v,R,B,x,b,p,E,M,F,T,P,_,w=o[0],C=o[1],U=o[2],y=Math.hypot(w,C,U);return y<t?null:(w*=y=1/y,C*=y,U*=y,n=Math.sin(e),s=1-(a=Math.cos(e)),h=r[0],u=r[1],f=r[2],l=r[3],c=r[4],m=r[5],d=r[6],A=r[7],g=r[8],v=r[9],R=r[10],B=r[11],x=w*w*s+a,b=C*w*s+U*n,p=U*w*s-C*n,E=w*C*s-U*n,M=C*C*s+a,F=U*C*s+w*n,T=w*U*s+C*n,P=C*U*s-w*n,_=U*U*s+a,i[0]=h*x+c*b+g*p,i[1]=u*x+m*b+v*p,i[2]=f*x+d*b+R*p,i[3]=l*x+A*b+B*p,i[4]=h*E+c*M+g*F,i[5]=u*E+m*M+v*F,i[6]=f*E+d*M+R*F,i[7]=l*E+A*M+B*F,i[8]=h*T+c*P+g*_,i[9]=u*T+m*P+v*_,i[10]=f*T+d*P+R*_,i[11]=l*T+A*P+B*_,r!==i&&(i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i)}var f=function(t,i,r,e,o){var n,a=1/Math.tan(i/2);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(n=1/(e-o),t[10]=(o+e)*n,t[14]=2*o*e*n):(t[10]=-1,t[14]=-2*e),t};function l(t,i,r){const e=t.createShader(i);return t.shaderSource(e,r),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS)?e:(console.error("Shader compilation error:",t.getShaderInfoLog(e)),t.deleteShader(e),null)}class c{constructor(t){this.gl=t,this.models=[],this.camera={position:o(0,2,5),target:o(0,0,0),up:o(0,1,0),rotation:{x:0,y:0}},this.mouseDown=!1,this.lastMousePos={x:0,y:0},this.setupGL(),this.initShaders(),this.setupMouseControls()}setupMouseControls(){const t=this.gl.canvas;t.addEventListener("mousedown",(t=>{t.preventDefault(),this.mouseDown=!0,this.lastMousePos={x:t.clientX,y:t.clientY}})),window.addEventListener("mouseup",(()=>{this.mouseDown=!1})),window.addEventListener("mousemove",(t=>{if(!this.mouseDown)return;const i=t.clientX-this.lastMousePos.x,r=t.clientY-this.lastMousePos.y;this.camera.rotation.y+=.005*i,this.camera.rotation.x=Math.max(-Math.PI/3,Math.min(Math.PI/3,this.camera.rotation.x+.005*r)),this.updateCameraPosition(),this.lastMousePos={x:t.clientX,y:t.clientY}})),t.addEventListener("wheel",(t=>{t.preventDefault();const i=.001*t.deltaY,o=r();n(o,this.camera.position,this.camera.target);const a=e(o)*(1+i);var s,h,u;a>2&&a<10&&(h=o,u=1+i,(s=o)[0]=h[0]*u,s[1]=h[1]*u,s[2]=h[2]*u,function(t,i,r){t[0]=i[0]+r[0],t[1]=i[1]+r[1],t[2]=i[2]+r[2]}(this.camera.position,this.camera.target,o))}))}updateCameraPosition(){const t=e(n(r(),this.camera.position,this.camera.target));this.camera.position[0]=this.camera.target[0]+t*Math.sin(this.camera.rotation.y)*Math.cos(this.camera.rotation.x),this.camera.position[1]=this.camera.target[1]+t*Math.sin(this.camera.rotation.x),this.camera.position[2]=this.camera.target[2]+t*Math.cos(this.camera.rotation.y)*Math.cos(this.camera.rotation.x)}setupGL(){const t=this.gl;t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(.9,.9,.9,1),this.resizeCanvas(),window.addEventListener("resize",(()=>this.resizeCanvas()))}resizeCanvas(){const t=this.gl.canvas,i=t.clientWidth,r=t.clientHeight;t.width===i&&t.height===r||(t.width=i,t.height=r,this.gl.viewport(0,0,t.width,t.height))}initShaders(){const t=this.gl,i=l(t,t.VERTEX_SHADER,"\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjMatrix;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec2 vTexCoord;\nvarying vec3 vOriginalPosition;\n\nvoid main() {\n    vNormal = mat3(uModelMatrix) * aNormal;\n    vec4 worldPos = uModelMatrix * vec4(aPosition, 1.0);\n    vPosition = worldPos.xyz;\n    vTexCoord = aTexCoord;\n    vOriginalPosition = aPosition;\n    gl_Position = uProjMatrix * uViewMatrix * worldPos;\n}"),r=l(t,t.FRAGMENT_SHADER,"\nprecision highp float;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec2 vTexCoord;\nvarying vec3 vOriginalPosition;\n\nuniform vec3 uLightPos;\nuniform vec3 uViewPos;\nuniform vec4 uBaseColor;\nuniform sampler2D uTexture;\nuniform bool uUseTexture;\n\nvoid main() {\n    vec3 normal = normalize(vNormal);\n    vec3 lightDir = normalize(uLightPos - vPosition);\n    vec3 viewDir = normalize(uViewPos - vPosition);\n    vec3 halfDir = normalize(lightDir + viewDir);\n\n    // Enhanced lighting model\n    float ambient = 0.2;\n    float diffuse = max(dot(normal, lightDir), 0.0);\n    float specular = pow(max(dot(normal, halfDir), 0.0), 64.0);\n    float fresnel = pow(1.0 - max(dot(normal, viewDir), 0.0), 4.0);\n\n    vec4 baseColor = uUseTexture ? texture2D(uTexture, vTexCoord) : uBaseColor;\n    \n    // Add subtle gradient based on height for the bookshelf\n    float heightGradient = (vOriginalPosition.y + 1.0) * 0.1;\n    baseColor.rgb += heightGradient;\n\n    // Combine lighting components\n    vec3 color = baseColor.rgb * (ambient + diffuse) + \n                 vec3(1.0) * specular * baseColor.a +\n                 vec3(0.5, 0.7, 1.0) * fresnel * baseColor.a;\n\n    gl_FragColor = vec4(color, baseColor.a);\n}");this.program=function(t,i,r){const e=t.createProgram();return t.attachShader(e,i),t.attachShader(e,r),t.linkProgram(e),t.getProgramParameter(e,t.LINK_STATUS)?e:(console.error("Program linking error:",t.getProgramInfoLog(e)),t.deleteProgram(e),null)}(t,i,r),this.locations={attributes:{position:t.getAttribLocation(this.program,"aPosition"),normal:t.getAttribLocation(this.program,"aNormal"),texCoord:t.getAttribLocation(this.program,"aTexCoord")},uniforms:{modelMatrix:t.getUniformLocation(this.program,"uModelMatrix"),viewMatrix:t.getUniformLocation(this.program,"uViewMatrix"),projMatrix:t.getUniformLocation(this.program,"uProjMatrix"),lightPos:t.getUniformLocation(this.program,"uLightPos"),viewPos:t.getUniformLocation(this.program,"uViewPos"),baseColor:t.getUniformLocation(this.program,"uBaseColor"),uTexture:t.getUniformLocation(this.program,"uTexture"),uUseTexture:t.getUniformLocation(this.program,"uUseTexture")}}}addModel(t){t.setProgram(this.program,this.locations),this.models.push(t)}render(){const i=this.gl;i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);const r=a(),e=a();!function(i,r,e,o){var n,a,s,h,u,f,l,c,m,d,A=r[0],g=r[1],v=r[2],R=o[0],B=o[1],x=o[2],b=e[0],p=e[1],E=e[2];Math.abs(A-b)<t&&Math.abs(g-p)<t&&Math.abs(v-E)<t?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(i):(l=A-b,c=g-p,m=v-E,n=B*(m*=d=1/Math.hypot(l,c,m))-x*(c*=d),a=x*(l*=d)-R*m,s=R*c-B*l,(d=Math.hypot(n,a,s))?(n*=d=1/d,a*=d,s*=d):(n=0,a=0,s=0),h=c*s-m*a,u=m*n-l*s,f=l*a-c*n,(d=Math.hypot(h,u,f))?(h*=d=1/d,u*=d,f*=d):(h=0,u=0,f=0),i[0]=n,i[1]=h,i[2]=l,i[3]=0,i[4]=a,i[5]=u,i[6]=c,i[7]=0,i[8]=s,i[9]=f,i[10]=m,i[11]=0,i[12]=-(n*A+a*g+s*v),i[13]=-(h*A+u*g+f*v),i[14]=-(l*A+c*g+m*v),i[15]=1)}(r,this.camera.position,this.camera.target,this.camera.up),f(e,45*Math.PI/180,i.canvas.width/i.canvas.height,.1,100),i.useProgram(this.program),i.uniformMatrix4fv(this.locations.uniforms.viewMatrix,!1,r),i.uniformMatrix4fv(this.locations.uniforms.projMatrix,!1,e),i.uniform3fv(this.locations.uniforms.lightPos,[5,5,5]),i.uniform3fv(this.locations.uniforms.viewPos,this.camera.position),this.models.forEach((t=>{t.render()}))}}class m{constructor(t){this.gl=t,this.position=[0,0,0],this.rotation=0,this.scale=[.15,.15,.15],this.initBuffers()}initBuffers(){const t=this.gl,i=[],r=[],e=[];this.generateBottleGeometry(i,r,e),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.STATIC_DRAW),this.indexCount=e.length}generateBottleGeometry(t,i,r){const e=[[0,-1],[.2,-.98],[.3,-.95],[.4,-.5],[.42,-.5],[.42,-.3],[.42,-.3],[.4,.1],[.5,.05],[.25,.3],[.25,.2],[.5,.7],[.4,.6],[.3,.5],[.2,.65],[.22,.7],[.2,.75],[.18,.8],[0,.85]];for(let o=0;o<=32;o++){const r=o/32*Math.PI*2,n=Math.sin(r),a=Math.cos(r);for(let o=0;o<e.length;o++){const[r,s]=e[o],h=r*a,u=r*n,f=s;t.push(h,f,u);let l=a,c=n,m=0;m=o<3?-.5:o<8?.1:o<14?.3:.5;const d=Math.sqrt(l*l+m*m+c*c);i.push(l/d,m/d,c/d)}}for(let o=0;o<32;o++)for(let t=0;t<e.length-1;t++){const i=o*e.length+t,n=(o+1)*e.length+t;r.push(i,n,i+1,n,n+1,i+1)}}setProgram(t,i){this.program=t,this.locations=i}render(){const t=this.gl,i=a();s(i,i,this.position),u(i,i,this.rotation,[0,1,0]),h(i,i,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,i),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[1,.85,.5,.9]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}class d{constructor(t){this.gl=t,this.position=[0,0,-3],this.rotation=0,this.scale=[1.5,2,.8],this.initBuffers()}initBuffers(){const t=this.gl,i=[],r=[],e=[];this.generateShelfGeometry(i,r,e),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.STATIC_DRAW),this.indexCount=e.length}generateShelfGeometry(t,i,r){const e=.4,o=.05,n=(e,o,n,a,s,h,u)=>{[[-a/2,-s/2,h/2],[a/2,-s/2,h/2],[a/2,s/2,h/2],[-a/2,s/2,h/2],[-a/2,-s/2,-h/2],[-a/2,s/2,-h/2],[a/2,s/2,-h/2],[a/2,-s/2,-h/2],[-a/2,s/2,-h/2],[-a/2,s/2,h/2],[a/2,s/2,h/2],[a/2,s/2,-h/2],[-a/2,-s/2,-h/2],[a/2,-s/2,-h/2],[a/2,-s/2,h/2],[-a/2,-s/2,h/2],[a/2,-s/2,-h/2],[a/2,s/2,-h/2],[a/2,s/2,h/2],[a/2,-s/2,h/2],[-a/2,-s/2,-h/2],[-a/2,-s/2,h/2],[-a/2,s/2,h/2],[-a/2,s/2,-h/2]].forEach((i=>{t.push(i[0]+e,i[1]+o,i[2]+n)}));[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]].forEach((t=>{for(let r=0;r<4;r++)i.push(...t)}));for(let t=0;t<6;t++){const i=u+4*t;r.push(i,i+1,i+2,i,i+2,i+3)}return u+24};let a=0;a=n(0,0,-.2,1,1,o,a);for(let s=0;s<3;s++){a=n(0,.2375*(s+1)-.5,0,1,o,e,a)}a=n(-.5,0,0,o,1,e,a),a=n(.5,0,0,o,1,e,a),a=n(0,-.5,0,1,o,e,a),n(0,.5,0,1,o,e,a)}setProgram(t,i){this.program=t,this.locations=i}render(){const t=this.gl,i=a();s(i,i,this.position),u(i,i,this.rotation,[0,1,0]),h(i,i,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,i),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[.4,.2,.1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}class A{constructor(t){this.gl=t,this.position=[0,0,0],this.rotation=0,this.scale=[4,.02,4],this.initBuffers()}initBuffers(){const t=this.gl,i=[0,1,2,0,2,3];this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,0,-1,-1,0,1,1,0,1,1,0,-1]),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(i),t.STATIC_DRAW),this.indexCount=i.length}setProgram(t,i){this.program=t,this.locations=i}render(){const t=this.gl,i=a();s(i,i,this.position),u(i,i,this.rotation,[0,1,0]),h(i,i,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,i),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[.9,.9,.92,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}let g=!1,v=null;!function(){const t=document.querySelector("#glCanvas").getContext("webgl",{alpha:!1,antialias:!0});if(!t)return void alert("Unable to initialize WebGL. Your browser may not support it.");const i=function(t){return new c(t)}(t),r=function(t){return new m(t)}(t),e=function(t){return new d(t)}(t),o=function(t){return new A(t)}(t);r.position=[.5,.35,2],e.position=[0,0,-2],o.position=[0,-1,0],i.addModel(o),i.addModel(e),i.addModel(r);const n=document.getElementById("toggleAnimation");function a(t){v||(v=t);const i=t-v,e=Math.min(i/5e3,1);if(e<1){const t=1-Math.pow(1-e,3),i=2,o=0,n=i-t*(i- -2),s=o-t*(o-.16);r.position[0]=.5,r.position[1]=s,r.position[2]=n,r.rotation=t*Math.PI*2,g&&requestAnimationFrame(a)}else g=!1,n.textContent="Start Animation",r.position=[.5,.16,-2],r.rotation=2*Math.PI}n.addEventListener("click",(()=>{g=!g,n.textContent=g?"Stop Animation":"Start Animation",g&&(v=performance.now(),a(performance.now()))})),function t(){i.render(),requestAnimationFrame(t)}()}()})();
//# sourceMappingURL=main.54aee8c1.js.map