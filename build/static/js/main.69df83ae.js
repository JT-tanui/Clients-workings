(()=>{"use strict";var t=1e-6,e="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;function i(){var t=new e(3);return e!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t){var e=t[0],i=t[1],o=t[2];return Math.hypot(e,i,o)}function r(t,i,o){var r=new e(3);return r[0]=t,r[1]=i,r[2]=o,r}function n(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});!function(){var t=i()}();function a(){var t=new e(16);return e!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function s(t,e,i){var o,r,n,a,s,h,u,l,f,c,m,d,A=i[0],g=i[1],v=i[2];return e===t?(t[12]=e[0]*A+e[4]*g+e[8]*v+e[12],t[13]=e[1]*A+e[5]*g+e[9]*v+e[13],t[14]=e[2]*A+e[6]*g+e[10]*v+e[14],t[15]=e[3]*A+e[7]*g+e[11]*v+e[15]):(o=e[0],r=e[1],n=e[2],a=e[3],s=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=e[9],m=e[10],d=e[11],t[0]=o,t[1]=r,t[2]=n,t[3]=a,t[4]=s,t[5]=h,t[6]=u,t[7]=l,t[8]=f,t[9]=c,t[10]=m,t[11]=d,t[12]=o*A+s*g+f*v+e[12],t[13]=r*A+h*g+c*v+e[13],t[14]=n*A+u*g+m*v+e[14],t[15]=a*A+l*g+d*v+e[15]),t}function h(t,e,i){var o=i[0],r=i[1],n=i[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function u(e,i,o,r){var n,a,s,h,u,l,f,c,m,d,A,g,v,R,x,B,p,b,M,E,F,P,T,_,w=r[0],C=r[1],y=r[2],U=Math.hypot(w,C,y);return U<t?null:(w*=U=1/U,C*=U,y*=U,n=Math.sin(o),s=1-(a=Math.cos(o)),h=i[0],u=i[1],l=i[2],f=i[3],c=i[4],m=i[5],d=i[6],A=i[7],g=i[8],v=i[9],R=i[10],x=i[11],B=w*w*s+a,p=C*w*s+y*n,b=y*w*s-C*n,M=w*C*s-y*n,E=C*C*s+a,F=y*C*s+w*n,P=w*y*s+C*n,T=C*y*s-w*n,_=y*y*s+a,e[0]=h*B+c*p+g*b,e[1]=u*B+m*p+v*b,e[2]=l*B+d*p+R*b,e[3]=f*B+A*p+x*b,e[4]=h*M+c*E+g*F,e[5]=u*M+m*E+v*F,e[6]=l*M+d*E+R*F,e[7]=f*M+A*E+x*F,e[8]=h*P+c*T+g*_,e[9]=u*P+m*T+v*_,e[10]=l*P+d*T+R*_,e[11]=f*P+A*T+x*_,i!==e&&(e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15]),e)}var l=function(t,e,i,o,r){var n,a=1/Math.tan(e/2);return t[0]=a/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(n=1/(o-r),t[10]=(r+o)*n,t[14]=2*r*o*n):(t[10]=-1,t[14]=-2*o),t};function f(t,e,i){const o=t.createShader(e);return t.shaderSource(o,i),t.compileShader(o),t.getShaderParameter(o,t.COMPILE_STATUS)?o:(console.error("Shader compilation error:",t.getShaderInfoLog(o)),t.deleteShader(o),null)}class c{constructor(t){this.gl=t,this.models=[],this.camera={position:r(0,2,5),target:r(0,0,0),up:r(0,1,0),rotation:{x:0,y:0}},this.mouseDown=!1,this.lastMousePos={x:0,y:0},this.setupGL(),this.initShaders(),this.setupMouseControls(),this.setupTouchControls()}setupMouseControls(){const t=this.gl.canvas;t.addEventListener("mousedown",(t=>{t.preventDefault(),this.mouseDown=!0,this.lastMousePos={x:t.clientX,y:t.clientY}})),window.addEventListener("mouseup",(()=>{this.mouseDown=!1})),window.addEventListener("mousemove",(t=>{if(!this.mouseDown)return;const e=t.clientX-this.lastMousePos.x,i=t.clientY-this.lastMousePos.y;this.camera.rotation.y+=.005*e,this.camera.rotation.x=Math.max(-Math.PI/3,Math.min(Math.PI/3,this.camera.rotation.x+.005*i)),this.updateCameraPosition(),this.lastMousePos={x:t.clientX,y:t.clientY}})),t.addEventListener("wheel",(t=>{t.preventDefault();const e=.001*t.deltaY,r=i();n(r,this.camera.position,this.camera.target);const a=o(r)*(1+e);var s,h,u;a>2&&a<10&&(h=r,u=1+e,(s=r)[0]=h[0]*u,s[1]=h[1]*u,s[2]=h[2]*u,function(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2]}(this.camera.position,this.camera.target,r))}))}setupTouchControls(){const t=this.gl.canvas;t.addEventListener("touchstart",(t=>{1===t.touches.length&&(this.mouseDown=!0,this.lastMousePos={x:t.touches[0].clientX,y:t.touches[0].clientY})})),t.addEventListener("touchend",(()=>{this.mouseDown=!1})),t.addEventListener("touchmove",(t=>{if(!this.mouseDown||1!==t.touches.length)return;const e=t.touches[0].clientX-this.lastMousePos.x,i=t.touches[0].clientY-this.lastMousePos.y;this.camera.rotation.y+=.005*e,this.camera.rotation.x=Math.max(-Math.PI/3,Math.min(Math.PI/3,this.camera.rotation.x+.005*i)),this.updateCameraPosition(),this.lastMousePos={x:t.touches[0].clientX,y:t.touches[0].clientY}}))}updateCameraPosition(){const t=o(n(i(),this.camera.position,this.camera.target));this.camera.position[0]=this.camera.target[0]+t*Math.sin(this.camera.rotation.y)*Math.cos(this.camera.rotation.x),this.camera.position[1]=this.camera.target[1]+t*Math.sin(this.camera.rotation.x),this.camera.position[2]=this.camera.target[2]+t*Math.cos(this.camera.rotation.y)*Math.cos(this.camera.rotation.x)}setupGL(){const t=this.gl;t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.clearColor(.9,.9,.9,1),this.resizeCanvas(),window.addEventListener("resize",(()=>this.resizeCanvas()))}resizeCanvas(){const t=this.gl.canvas,e=t.clientWidth,i=t.clientHeight;t.width===e&&t.height===i||(t.width=e,t.height=i,this.gl.viewport(0,0,t.width,t.height))}initShaders(){const t=this.gl,e=f(t,t.VERTEX_SHADER,"\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjMatrix;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec2 vTexCoord;\nvarying vec3 vOriginalPosition;\n\nvoid main() {\n    vNormal = mat3(uModelMatrix) * aNormal;\n    vec4 worldPos = uModelMatrix * vec4(aPosition, 1.0);\n    vPosition = worldPos.xyz;\n    vTexCoord = aTexCoord;\n    vOriginalPosition = aPosition;\n    gl_Position = uProjMatrix * uViewMatrix * worldPos;\n}"),i=f(t,t.FRAGMENT_SHADER,"\nprecision highp float;\n\nvarying vec3 vNormal;\nvarying vec3 vPosition;\nvarying vec2 vTexCoord;\nvarying vec3 vOriginalPosition;\n\nuniform vec3 uLightPos;\nuniform vec3 uViewPos;\nuniform vec4 uBaseColor;\nuniform sampler2D uTexture;\nuniform bool uUseTexture;\n\nvoid main() {\n    vec3 normal = normalize(vNormal);\n    vec3 lightDir = normalize(uLightPos - vPosition);\n    vec3 viewDir = normalize(uViewPos - vPosition);\n    vec3 halfDir = normalize(lightDir + viewDir);\n\n    // Enhanced lighting model\n    float ambient = 0.2;\n    float diffuse = max(dot(normal, lightDir), 0.0);\n    float specular = pow(max(dot(normal, halfDir), 0.0), 64.0);\n    float fresnel = pow(1.0 - max(dot(normal, viewDir), 0.0), 4.0);\n\n    vec4 baseColor = uUseTexture ? texture2D(uTexture, vTexCoord) : uBaseColor;\n    \n    // Add subtle gradient based on height for the bookshelf\n    float heightGradient = (vOriginalPosition.y + 1.0) * 0.1;\n    baseColor.rgb += heightGradient;\n\n    // Combine lighting components\n    vec3 color = baseColor.rgb * (ambient + diffuse) + \n                 vec3(1.0) * specular * baseColor.a +\n                 vec3(0.5, 0.7, 1.0) * fresnel * baseColor.a;\n\n    gl_FragColor = vec4(color, baseColor.a);\n}");this.program=function(t,e,i){const o=t.createProgram();return t.attachShader(o,e),t.attachShader(o,i),t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)?o:(console.error("Program linking error:",t.getProgramInfoLog(o)),t.deleteProgram(o),null)}(t,e,i),this.locations={attributes:{position:t.getAttribLocation(this.program,"aPosition"),normal:t.getAttribLocation(this.program,"aNormal"),texCoord:t.getAttribLocation(this.program,"aTexCoord")},uniforms:{modelMatrix:t.getUniformLocation(this.program,"uModelMatrix"),viewMatrix:t.getUniformLocation(this.program,"uViewMatrix"),projMatrix:t.getUniformLocation(this.program,"uProjMatrix"),lightPos:t.getUniformLocation(this.program,"uLightPos"),viewPos:t.getUniformLocation(this.program,"uViewPos"),baseColor:t.getUniformLocation(this.program,"uBaseColor"),uTexture:t.getUniformLocation(this.program,"uTexture"),uUseTexture:t.getUniformLocation(this.program,"uUseTexture")}}}addModel(t){t.setProgram(this.program,this.locations),this.models.push(t)}render(){const e=this.gl;e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const i=a(),o=a();!function(e,i,o,r){var n,a,s,h,u,l,f,c,m,d,A=i[0],g=i[1],v=i[2],R=r[0],x=r[1],B=r[2],p=o[0],b=o[1],M=o[2];Math.abs(A-p)<t&&Math.abs(g-b)<t&&Math.abs(v-M)<t?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(e):(f=A-p,c=g-b,m=v-M,n=x*(m*=d=1/Math.hypot(f,c,m))-B*(c*=d),a=B*(f*=d)-R*m,s=R*c-x*f,(d=Math.hypot(n,a,s))?(n*=d=1/d,a*=d,s*=d):(n=0,a=0,s=0),h=c*s-m*a,u=m*n-f*s,l=f*a-c*n,(d=Math.hypot(h,u,l))?(h*=d=1/d,u*=d,l*=d):(h=0,u=0,l=0),e[0]=n,e[1]=h,e[2]=f,e[3]=0,e[4]=a,e[5]=u,e[6]=c,e[7]=0,e[8]=s,e[9]=l,e[10]=m,e[11]=0,e[12]=-(n*A+a*g+s*v),e[13]=-(h*A+u*g+l*v),e[14]=-(f*A+c*g+m*v),e[15]=1)}(i,this.camera.position,this.camera.target,this.camera.up),l(o,45*Math.PI/180,e.canvas.width/e.canvas.height,.1,100),e.useProgram(this.program),e.uniformMatrix4fv(this.locations.uniforms.viewMatrix,!1,i),e.uniformMatrix4fv(this.locations.uniforms.projMatrix,!1,o),e.uniform3fv(this.locations.uniforms.lightPos,[5,5,5]),e.uniform3fv(this.locations.uniforms.viewPos,this.camera.position),this.models.forEach((t=>{t.render()}))}}class m{constructor(t){this.gl=t,this.position=[0,0,0],this.rotation=0,this.scale=[.15,.15,.15],this.initBuffers()}initBuffers(){const t=this.gl,e=[],i=[],o=[];this.generateBottleGeometry(e,i,o),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),t.STATIC_DRAW),this.indexCount=o.length}generateBottleGeometry(t,e,i){const o=[[0,-1],[.2,-.98],[.3,-.95],[.4,-.5],[.42,-.5],[.42,-.3],[.42,-.3],[.4,.1],[.5,.05],[.25,.3],[.25,.2],[.5,.7],[.4,.6],[.3,.5],[.2,.65],[.22,.7],[.2,.75],[.18,.8],[0,.85]];for(let r=0;r<=32;r++){const i=r/32*Math.PI*2,n=Math.sin(i),a=Math.cos(i);for(let r=0;r<o.length;r++){const[i,s]=o[r],h=i*a,u=i*n,l=s;t.push(h,l,u);let f=a,c=n,m=0;m=r<3?-.5:r<8?.1:r<14?.3:.5;const d=Math.sqrt(f*f+m*m+c*c);e.push(f/d,m/d,c/d)}}for(let r=0;r<32;r++)for(let t=0;t<o.length-1;t++){const e=r*o.length+t,n=(r+1)*o.length+t;i.push(e,n,e+1,n,n+1,e+1)}}setProgram(t,e){this.program=t,this.locations=e}render(){const t=this.gl,e=a();s(e,e,this.position),u(e,e,this.rotation,[0,1,0]),h(e,e,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,e),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[1,.85,.5,.9]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}class d{constructor(t){this.gl=t,this.position=[0,0,-3],this.rotation=0,this.scale=[1.5,2,.8],this.initBuffers()}initBuffers(){const t=this.gl,e=[],i=[],o=[];this.generateShelfGeometry(e,i,o),this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(i),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(o),t.STATIC_DRAW),this.indexCount=o.length}generateShelfGeometry(t,e,i){const o=.4,r=.05,n=(o,r,n,a,s,h,u)=>{[[-a/2,-s/2,h/2],[a/2,-s/2,h/2],[a/2,s/2,h/2],[-a/2,s/2,h/2],[-a/2,-s/2,-h/2],[-a/2,s/2,-h/2],[a/2,s/2,-h/2],[a/2,-s/2,-h/2],[-a/2,s/2,-h/2],[-a/2,s/2,h/2],[a/2,s/2,h/2],[a/2,s/2,-h/2],[-a/2,-s/2,-h/2],[a/2,-s/2,-h/2],[a/2,-s/2,h/2],[-a/2,-s/2,h/2],[a/2,-s/2,-h/2],[a/2,s/2,-h/2],[a/2,s/2,h/2],[a/2,-s/2,h/2],[-a/2,-s/2,-h/2],[-a/2,-s/2,h/2],[-a/2,s/2,h/2],[-a/2,s/2,-h/2]].forEach((e=>{t.push(e[0]+o,e[1]+r,e[2]+n)}));[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]].forEach((t=>{for(let i=0;i<4;i++)e.push(...t)}));for(let t=0;t<6;t++){const e=u+4*t;i.push(e,e+1,e+2,e,e+2,e+3)}return u+24};let a=0;a=n(0,0,-.2,1,1,r,a);for(let s=0;s<3;s++){a=n(0,.2375*(s+1)-.5,0,1,r,o,a)}a=n(-.5,0,0,r,1,o,a),a=n(.5,0,0,r,1,o,a),a=n(0,-.5,0,1,r,o,a),n(0,.5,0,1,r,o,a)}setProgram(t,e){this.program=t,this.locations=e}render(){const t=this.gl,e=a();s(e,e,this.position),u(e,e,this.rotation,[0,1,0]),h(e,e,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,e),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[.4,.2,.1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}class A{constructor(t){this.gl=t,this.position=[0,0,0],this.rotation=0,this.scale=[4,.02,4],this.initBuffers()}initBuffers(){const t=this.gl,e=[0,1,2,0,2,3];this.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,0,-1,-1,0,1,1,0,1,1,0,-1]),t.STATIC_DRAW),this.normalBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,0,1,0,0,1,0]),t.STATIC_DRAW),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),t.STATIC_DRAW),this.indexCount=e.length}setProgram(t,e){this.program=t,this.locations=e}render(){const t=this.gl,e=a();s(e,e,this.position),u(e,e,this.rotation,[0,1,0]),h(e,e,this.scale),t.uniformMatrix4fv(this.locations.uniforms.modelMatrix,!1,e),t.uniform1i(this.locations.uniforms.uUseTexture,0),t.uniform4fv(this.locations.uniforms.baseColor,[.9,.9,.92,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.vertexAttribPointer(this.locations.attributes.position,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.position),t.bindBuffer(t.ARRAY_BUFFER,this.normalBuffer),t.vertexAttribPointer(this.locations.attributes.normal,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(this.locations.attributes.normal),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,this.indexCount,t.UNSIGNED_SHORT,0)}}let g=!1,v=null;!function(){const t=document.querySelector("#glCanvas").getContext("webgl",{alpha:!1,antialias:!0});if(!t)return void alert("Unable to initialize WebGL. Your browser may not support it.");const e=function(t){return new c(t)}(t),i=function(t){return new m(t)}(t),o=function(t){return new d(t)}(t),r=function(t){return new A(t)}(t);i.position=[.5,.35,2],o.position=[0,0,-2],r.position=[0,-1,0],e.addModel(r),e.addModel(o),e.addModel(i);const n=document.getElementById("toggleAnimation");function a(t){v||(v=t);const e=t-v,o=Math.min(e/5e3,1);if(o<1){const t=1-Math.pow(1-o,3),e=2,r=0,n=e-t*(e- -2),s=r-t*(r-.16);i.position[0]=.5,i.position[1]=s,i.position[2]=n,i.rotation=t*Math.PI*2,g&&requestAnimationFrame(a)}else g=!1,n.textContent="Start Animation",i.position=[.5,.16,-2],i.rotation=2*Math.PI}n.addEventListener("click",(()=>{g=!g,n.textContent=g?"Stop Animation":"Start Animation",g&&(v=performance.now(),a(performance.now()))})),function t(){e.render(),requestAnimationFrame(t)}()}()})();
//# sourceMappingURL=main.69df83ae.js.map